{"version":3,"file":"contextBuilder.iife.js","sources":["../../src/Select/index.js","../../src/CursorPlacement/index.js","../../src/index.js","../../render/index.js"],"sourcesContent":["export class Select {\n    constructor(selector) {\n        // Check if document and document.body exist\n        this.body = typeof document !== 'undefined' && document && document.body;\n        // Resolve references\n        this.elements = [];\n        if (this.body && selector) {\n            if (typeof selector === 'string') {\n                this.elements = [...document.querySelectorAll(selector)];\n            } else if (selector instanceof Node) {\n                this.elements = [selector];\n            } else if (\n                selector instanceof NodeList\n                || selector instanceof HTMLCollection\n            ) {\n                this.elements = [...selector];\n            } else if (Object.prototype.hasOwnProperty.call(selector, 'length')) { // For jQuery or jQuery like objects\n                for (let i = 0; i < selector.length; i++) {\n                    this.elements.push(selector[i]);\n                }\n            } else if (selector instanceof Select) {\n                this.elements = [...selector.elements];\n                this.parent = selector.parent;\n            }\n        }\n        // Resolve parent\n        this.parent = this.getParentSelection();\n    }\n    /**\n     * Returns a Select object for parent nodes\n     */\n    getParentSelection() {\n        const parentNodeList = this.elements.map(el => el.parentNode).filter(el => !!el);\n        if (parentNodeList.length) {\n            return new Select(parentNodeList);\n        }\n        return null;\n    }\n    /**\n     * Query children of current element\n     * @param {string} selector Selector\n     */\n    query(selector) {\n        const selected = [];\n        this.elements.forEach(el => {\n            const children = [...el.querySelectorAll(selector)];\n            children.forEach(child => {\n                if (selected.indexOf(child) === -1) {\n                    selected.push(children);\n                }\n            });\n        });\n        return new Select(selected);\n    }\n    /**\n     * Appends HTML body to current element(s)\n     * @param {string | Node | NodeList | HTMLCollection | Node[] | Select} nodes \n     */\n    append(nodes) {\n        if (this.body) {\n            let consumableNodes;\n            if (typeof nodes === 'string') {\n                // Expecting a plain HTML string\n                const tempDiv = document.createElement('div');\n                tempDiv.innerHTML = nodes;\n                consumableNodes = new Select(tempDiv.childNodes);\n            } else {\n                // For everything else treat them as regular nodes\n                consumableNodes = new Select(nodes);\n            }\n            this.elements.forEach((target, i) => {\n                if (consumableNodes.elements.length === 1) {\n                    target.appendChild(consumableNodes.elements[0]); // Keeping intact the original reference\n                } else {\n                    const fragment = document.createDocumentFragment();\n                    consumableNodes.elements.forEach(n => {\n                        fragment.appendChild(i === 0 ? n : n.cloneNode());\n                    });\n                    target.appendChild(fragment);\n                }\n            });\n        }\n        return this;\n    }\n    /**\n     * Prepends HTML body to current element(s)\n     * @param {string | Node | NodeList | HTMLCollection | Node[] | Select} nodes\n     */\n    prepend(nodes) {\n        if (this.body) {\n            this.elements.forEach(target => {\n                const currentFragment = (new Select(target.childNodes)).detach();\n                (new Select(target)).append(nodes).append(currentFragment);\n            });\n        }\n        return this;\n    }\n    /**\n     * Removes current set of elements from DOM and return DocumentFragment as a Select instance\n     */\n    detach() {\n        if (this.body) {\n            const fragment = document.createDocumentFragment();\n            this.elements.forEach(el => {\n                fragment.appendChild(el);\n            });\n            return new Select(fragment);\n        }\n        return this;\n    }\n    /**\n     * Clears current elements inner HTML\n     */\n    clear() {\n        if (this.body) {\n            this.elements.forEach(el => {\n                el.innerHTML = '';\n            });\n        }\n        return this;\n    }\n    /**\n     * Returns current map of HTML strings\n     */\n    htmlMap() {\n        return this.map(el => el.innerHTML);\n    }\n    /**\n     * Returns current map of text strings\n     */\n    textMap() {\n        return this.map(el => el.textContent || el.innerText);\n    }\n    /**\n     * Returns current list of element as array\n     * @param {Function} evaluatorFn Evaluator function\n     */\n    map(evaluatorFn) {\n        if (!this.body || typeof evaluatorFn !== 'function') {\n            return this.elements;\n        }\n        return this.elements.map(evaluatorFn);\n    }\n    /**\n     * Returns current body tag as a Select instance\n     */\n    getBodyTag() {\n        return new Select(this.body);\n    }\n    /**\n     * Returns current Select reference children\n     */\n    children() {\n        const elements = [];\n        this.elements.forEach(el => {\n            [...el.childNodes].forEach(n => {\n                if (elements.indexOf(n) === -1) {\n                    elements.push(n);\n                }\n            });\n        });\n        return new Select(elements);\n    }\n    /**\n     * Binds a regular event listener\n     */\n    on() {\n        this.elements.forEach(el => {\n            el.addEventListener(...arguments);\n        });\n        return this;\n    }\n    /**\n     * Removes a regular event listener\n     */\n    off() {\n        this.elements.forEach(el => {\n            el.removeEventListener(...arguments);\n        });\n        return this;\n    }\n    /**\n     * Auto detach event listener after first call\n     * @param {string} eventType Event name\n     * @param {Function} cb Callback function\n     * @param {boolean} useCapture Use capture mode\n     */\n    once(eventType, cb, useCapture) {\n        const ref = this;\n        const onceCb = function () {\n            cb.apply(this, arguments);\n            ref.elements.forEach(el => {\n                el.removeEventListener(eventType, onceCb, useCapture);\n            });\n        };\n        this.elements.forEach(el => {\n            el.addEventListener(eventType, onceCb, useCapture);\n        });\n    }\n    /**\n     * Returns map of DOMRect objects\n     */\n    bounds() {\n        return this.map(el => el.getBoundingClientRect());\n    }\n    /**\n     * Sets CSS properties to element(s)\n     * @param {object} obj CSS properties\n     */\n    setCSSProps(obj) {\n        this.elements.forEach(el => {\n            Object.keys(obj).forEach(prop => {\n                el.style[prop] = obj[prop];\n            });\n        });\n        return this;\n    }\n    /**\n     * Sets HTML element attributes\n     * @param {object} obj HTML element attributes\n     */\n    setAttr(obj) {\n        this.elements.forEach(el => {\n            Object.keys(obj).forEach(attr => {\n                el.setAttribute(attr, obj[attr]);\n            });\n        });\n        return this;\n    }\n    /**\n     * Returns a map of attribute values for selected elements\n     * @param {string} attr Attribute\n     */\n    getAttrMap(attr) {\n        return this.map(el => el.getAttribute(attr));\n    }\n    /**\n     * Enforce a repaint of targeted elements\n     */\n    repaint() {\n        this.elements.forEach(el => {\n            el.offsetHeight; // Accessing offset height somehow triggers a reflow\n        });\n        return this;\n    }\n    /**\n     * Returns true if current element is contained in this selector\n     * @param {Node | NodeList | HTMLCollection | Select} nodes Element\n     */\n    contains(nodes) {\n        return (new Select(nodes)).map(n => {\n            for (const el of this.elements) {\n                if (el.contains(n)) {\n                    return true;\n                }\n            }\n            return false;\n        }).indexOf(false) === -1;\n    }\n    /**\n     * Static method to create a new HTML node\n     * @param {string | Node | NodeList | HTMLCollection | Node[] | Select} nodes\n     */\n    static create(nodes) {\n        return (new Select(document.createDocumentFragment()))\n            .append(nodes)\n            .children();\n    }\n}","import { Select } from '../Select';\n\nexport class CursorPlacement {\n    constructor(event, element) {\n        this.target = new Select(element);\n        this.targetPlacement = this.target.bounds()[0];\n        this.windowProps = {\n            width: window.innerWidth,\n            height: window.innerHeight\n        };\n        this.target.setCSSProps({\n            position: 'fixed',\n            top: `${this.getClientY(event)}px`,\n            left: `${this.getClientX(event)}px`,\n            maxWidth: `${this.windowProps.width - 10}px`,\n            maxHeight: `${this.windowProps.height - 10}px`,\n            overflow: 'auto'\n        });\n    }\n    /**\n     * Returns context menu's approximate position on X axis\n     * @param {Event} event Event object\n     */\n    getClientX(event) {\n        const displacement = event.clientX + this.targetPlacement.width - this.windowProps.width;\n        if (displacement > 0) {\n            return event.clientX - displacement - 4;\n        }\n        return event.clientX;\n    }\n    /**\n     * Returns context menu's approximate position on Y axis\n     * @param {Event} event Event object\n     */\n    getClientY(event) {\n        const displacement = event.clientY + this.targetPlacement.height - this.windowProps.height;\n        if (displacement > 0) {\n            return event.clientY - displacement - 4;\n        }\n        return event.clientY;\n    }\n}","import { Select } from './Select';\nimport { CursorPlacement } from './CursorPlacement';\n\n\nexport class ContextMenu {\n    #listeners = [];\n    #open = false;\n    constructor(target, config) {\n        if (config && typeof config === 'object') {\n            this.config = Object.freeze(config);\n        }\n        this.contextTarget = typeof target === 'string'\n            ? new Select(target)\n            : new Select().getBodyTag();\n        this.isSupported = !!this.contextTarget.body;\n        this.rootElement = Select.create(\n            this.config && this.config.rootElement\n                ? this.config.rootElement\n                : `<ul class=\"context-menu-list\"></ul>`\n        );\n        const ref = this;\n        const onContextMenu = function (e) {\n            e.preventDefault();\n            if (!ref.#open) {\n                (new Select(this)).append(ref.rootElement);\n                new CursorPlacement(e, ref.rootElement);\n                if (\n                    ref.config\n                    && typeof ref.config.onActivate === 'function'\n                ) {\n                    ref.rootElement.repaint();\n                    config.onActivate(ref.rootElement);\n                    ref.#open = true;\n                }\n            }\n        };\n        const exitFunction = () => {\n            this.rootElement = this.rootElement.detach().children();\n            this.#open = false;\n        };\n        const onClick = () => {\n            if (\n                this.config\n                && typeof config.onDeactivate === 'function'\n            ) {\n                config.onDeactivate(this.rootElement, exitFunction);\n            } else {\n                exitFunction();\n            }\n        };\n        const onRootClick = (e) => {\n            e.stopPropagation();\n            if (\n                this.config\n                && typeof this.config.onClick === 'function'\n            ) {\n                const shouldExit = this.config.onClick.apply(new Select(e.target), [e]);\n                if (shouldExit) {\n                    if (typeof this.config.onDeactivate === 'function') {\n                        this.config.onDeactivate(this.rootElement, exitFunction);\n                    } else {\n                        exitFunction();\n                    }\n                }\n            }\n        };\n        this.#listeners.push(\n            { onContextMenu },\n            { onClick },\n            { onRootClick }\n        );\n        this.contextTarget\n            .on('contextmenu', onContextMenu)\n            .on('click', onClick);\n        this.rootElement.on('click', onRootClick);\n    }\n    add() {\n        const elements = [...arguments];\n        for (const element of elements) {\n            if (\n                element instanceof ContextList\n                || element instanceof ContextItem\n            ) {\n                this.rootElement.append(element.rootElement);\n            }\n        }\n    }\n    cleanup() {\n        const { onContextMenu } = this.#listeners.filter(fn => Object.prototype.hasOwnProperty.call(fn, 'onContextMenu'))[0];\n        const { onClick } = this.#listeners.filter(fn => Object.prototype.hasOwnProperty.call(fn, 'onClick'))[0];\n        const { onRootClick } = this.#listeners.filter(fn => Object.prototype.hasOwnProperty.call(fn, 'onRootClick'))[0];\n        this.contextTarget\n            .off('contextmenu', onContextMenu)\n            .off('click', onClick);\n        this.rootElement.off('click', onRootClick);\n    }\n}\n\n// Generates a context list\nexport class ContextList {\n    constructor(title, config) {\n        if (config && typeof config === 'object') {\n            this.config = Object.freeze(config);\n        }\n        this.rootElement = Select.create(\n            this.config && this.config.rootElement\n                ? this.config.rootElement\n                : `<li class=\"menu-item\"></li>`\n        );\n        this.rootElement.setAttr({\n            'data-has-sub-elements': true\n        });\n        this.listElement = Select.create(\n            this.config && this.config.listElement\n                ? this.config.listElement\n                : `<ul class=\"context-submenu\"></ul>`\n        );\n        this.rootElement\n            .append(title)\n            .append(this.listElement);\n    }\n    get parent() {\n        return this.rootElement.parent;\n    }\n    add() {\n        const elements = [...arguments];\n        for (const element of elements) {\n            if (\n                element instanceof ContextList\n                || element instanceof ContextItem\n            ) {\n                this.listElement.append(element.rootElement);\n            }\n        }\n    }\n}\n\n// Generates a context item\nexport class ContextItem {\n    constructor(title, config) {\n        if (config && typeof config === 'object') {\n            this.config = Object.freeze();\n        }\n        this.rootElement = Select.create(\n            this.config && this.config.rootElement\n                ? this.config.rootElement\n                : `<li class=\"menu-item\"></li>`\n        );\n        this.rootElement.append(title);\n    }\n}","import { ContextMenu, ContextItem } from '../src';\n\nconst menu = new ContextMenu(null, {\n    onClick() {\n        console.log(this.textMap());\n        return true;\n    },\n    onActivate(rootEl) {\n        rootEl.map(el => el.classList.add('show'));\n    },\n    onDeactivate(rootEl, fn) {\n        rootEl.once('transitionend', fn);\n        rootEl.map(el => el.classList.remove('show'));\n    }\n});\nmenu.add(\n    new ContextItem('List Item 1'),\n    new ContextItem('List Item 2'),\n    new ContextItem('List Item 3'),\n    new ContextItem('List Item 4'),\n    new ContextItem('List Item 5'),\n    new ContextItem('List Item 6')\n);"],"names":["Select","selector","body","document","elements","querySelectorAll","Node","NodeList","HTMLCollection","Object","prototype","hasOwnProperty","call","i","length","push","parent","getParentSelection","parentNodeList","map","el","parentNode","filter","selected","forEach","children","child","indexOf","nodes","consumableNodes","tempDiv","createElement","innerHTML","childNodes","target","appendChild","fragment","createDocumentFragment","n","cloneNode","currentFragment","detach","append","textContent","innerText","evaluatorFn","addEventListener","arguments","removeEventListener","eventType","cb","useCapture","ref","onceCb","apply","getBoundingClientRect","obj","keys","prop","style","attr","setAttribute","getAttribute","offsetHeight","contains","CursorPlacement","event","element","targetPlacement","bounds","windowProps","width","window","innerWidth","height","innerHeight","setCSSProps","position","top","getClientY","left","getClientX","maxWidth","maxHeight","overflow","displacement","clientX","clientY","ContextMenu","config","freeze","contextTarget","getBodyTag","isSupported","rootElement","create","onContextMenu","e","preventDefault","onActivate","repaint","exitFunction","onClick","onDeactivate","onRootClick","stopPropagation","shouldExit","on","ContextList","ContextItem","fn","off","title","setAttr","listElement","menu","console","log","textMap","rootEl","classList","add","once","remove"],"mappings":"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"}