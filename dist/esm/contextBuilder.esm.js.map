{"version":3,"file":"contextBuilder.esm.js","sources":["../../src/Select/index.js","../../src/CursorPlacement/index.js","../../src/index.js"],"sourcesContent":["export class Select {\n    constructor(selector) {\n        // Check if document and document.body exist\n        this.body = typeof document !== 'undefined' && document && document.body;\n        // Resolve references\n        this.elements = [];\n        if (this.body && selector) {\n            if (typeof selector === 'string') {\n                this.elements = [...document.querySelectorAll(selector)];\n            } else if (selector instanceof Node) {\n                this.elements = [selector];\n            } else if (\n                selector instanceof NodeList\n                || selector instanceof HTMLCollection\n            ) {\n                this.elements = [...selector];\n            } else if (Object.prototype.hasOwnProperty.call(selector, 'length')) { // For jQuery or jQuery like objects\n                for (let i = 0; i < selector.length; i++) {\n                    this.elements.push(selector[i]);\n                }\n            } else if (selector instanceof Select) {\n                this.elements = [...selector.elements];\n                this.parent = selector.parent;\n            }\n        }\n        // Resolve parent\n        this.parent = this.getParentSelection();\n    }\n    /**\n     * Returns a Select object for parent nodes\n     */\n    getParentSelection() {\n        const parentNodeList = this.elements.map(el => el.parentNode).filter(el => !!el);\n        if (parentNodeList.length) {\n            return new Select(parentNodeList);\n        }\n        return null;\n    }\n    /**\n     * Query children of current element\n     * @param {string} selector Selector\n     */\n    query(selector) {\n        const selected = [];\n        this.elements.forEach(el => {\n            const children = [...el.querySelectorAll(selector)];\n            children.forEach(child => {\n                if (selected.indexOf(child) === -1) {\n                    selected.push(children);\n                }\n            });\n        });\n        return new Select(selected);\n    }\n    /**\n     * Appends HTML body to current element(s)\n     * @param {string | Node | NodeList | HTMLCollection | Node[] | Select} nodes \n     */\n    append(nodes) {\n        if (this.body) {\n            let consumableNodes;\n            if (typeof nodes === 'string') {\n                // Expecting a plain HTML string\n                const tempDiv = document.createElement('div');\n                tempDiv.innerHTML = nodes;\n                consumableNodes = new Select(tempDiv.childNodes);\n            } else {\n                // For everything else treat them as regular nodes\n                consumableNodes = new Select(nodes);\n            }\n            this.elements.forEach((target, i) => {\n                if (consumableNodes.elements.length === 1) {\n                    target.appendChild(consumableNodes.elements[0]); // Keeping intact the original reference\n                } else {\n                    const fragment = document.createDocumentFragment();\n                    consumableNodes.elements.forEach(n => {\n                        fragment.appendChild(i === 0 ? n : n.cloneNode());\n                    });\n                    target.appendChild(fragment);\n                }\n            });\n        }\n        return this;\n    }\n    /**\n     * Prepends HTML body to current element(s)\n     * @param {string | Node | NodeList | HTMLCollection | Node[] | Select} nodes\n     */\n    prepend(nodes) {\n        if (this.body) {\n            this.elements.forEach(target => {\n                const currentFragment = (new Select(target.childNodes)).detach();\n                (new Select(target)).append(nodes).append(currentFragment);\n            });\n        }\n        return this;\n    }\n    /**\n     * Removes current set of elements from DOM and return DocumentFragment as a Select instance\n     */\n    detach() {\n        if (this.body) {\n            const fragment = document.createDocumentFragment();\n            this.elements.forEach(el => {\n                fragment.appendChild(el);\n            });\n            return new Select(fragment);\n        }\n        return this;\n    }\n    /**\n     * Clears current elements inner HTML\n     */\n    clear() {\n        if (this.body) {\n            this.elements.forEach(el => {\n                el.innerHTML = '';\n            });\n        }\n        return this;\n    }\n    /**\n     * Returns current map of HTML strings\n     */\n    htmlMap() {\n        return this.map(el => el.innerHTML);\n    }\n    /**\n     * Returns current map of text strings\n     */\n    textMap() {\n        return this.map(el => el.textContent || el.innerText);\n    }\n    /**\n     * Returns current list of element as array\n     * @param {Function} evaluatorFn Evaluator function\n     */\n    map(evaluatorFn) {\n        if (!this.body || typeof evaluatorFn !== 'function') {\n            return this.elements;\n        }\n        return this.elements.map(evaluatorFn);\n    }\n    /**\n     * Returns current body tag as a Select instance\n     */\n    getBodyTag() {\n        return new Select(this.body);\n    }\n    /**\n     * Returns current Select reference children\n     */\n    children() {\n        const elements = [];\n        this.elements.forEach(el => {\n            [...el.childNodes].forEach(n => {\n                if (elements.indexOf(n) === -1) {\n                    elements.push(n);\n                }\n            });\n        });\n        return new Select(elements);\n    }\n    /**\n     * Binds a regular event listener\n     */\n    on() {\n        this.elements.forEach(el => {\n            el.addEventListener(...arguments);\n        });\n        return this;\n    }\n    /**\n     * Removes a regular event listener\n     */\n    off() {\n        this.elements.forEach(el => {\n            el.removeEventListener(...arguments);\n        });\n        return this;\n    }\n    /**\n     * Auto detach event listener after first call\n     * @param {string} eventType Event name\n     * @param {Function} cb Callback function\n     * @param {boolean} useCapture Use capture mode\n     */\n    once(eventType, cb, useCapture) {\n        const ref = this;\n        const onceCb = function () {\n            cb.apply(this, arguments);\n            ref.elements.forEach(el => {\n                el.removeEventListener(eventType, onceCb, useCapture);\n            });\n        };\n        this.elements.forEach(el => {\n            el.addEventListener(eventType, onceCb, useCapture);\n        });\n    }\n    /**\n     * Returns map of DOMRect objects\n     */\n    bounds() {\n        return this.map(el => el.getBoundingClientRect());\n    }\n    /**\n     * Sets CSS properties to element(s)\n     * @param {object} obj CSS properties\n     */\n    setCSSProps(obj) {\n        this.elements.forEach(el => {\n            Object.keys(obj).forEach(prop => {\n                el.style[prop] = obj[prop];\n            });\n        });\n        return this;\n    }\n    /**\n     * Sets HTML element attributes\n     * @param {object} obj HTML element attributes\n     */\n    setAttr(obj) {\n        this.elements.forEach(el => {\n            Object.keys(obj).forEach(attr => {\n                el.setAttribute(attr, obj[attr]);\n            });\n        });\n        return this;\n    }\n    /**\n     * Returns a map of attribute values for selected elements\n     * @param {string} attr Attribute\n     */\n    getAttrMap(attr) {\n        return this.map(el => el.getAttribute(attr));\n    }\n    /**\n     * Enforce a repaint of targeted elements\n     */\n    repaint() {\n        this.elements.forEach(el => {\n            el.offsetHeight; // Accessing offset height somehow triggers a reflow\n        });\n        return this;\n    }\n    /**\n     * Returns true if current element is contained in this selector\n     * @param {Node | NodeList | HTMLCollection | Select} nodes Element\n     */\n    contains(nodes) {\n        return (new Select(nodes)).map(n => {\n            for (const el of this.elements) {\n                if (el.contains(n)) {\n                    return true;\n                }\n            }\n            return false;\n        }).indexOf(false) === -1;\n    }\n    /**\n     * Static method to create a new HTML node\n     * @param {string | Node | NodeList | HTMLCollection | Node[] | Select} nodes\n     */\n    static create(nodes) {\n        return (new Select(document.createDocumentFragment()))\n            .append(nodes)\n            .children();\n    }\n}","import { Select } from '../Select';\n\nexport class CursorPlacement {\n    constructor(event, element) {\n        this.target = new Select(element);\n        this.targetPlacement = this.target.bounds()[0];\n        this.windowProps = {\n            width: window.innerWidth,\n            height: window.innerHeight\n        };\n        this.target.setCSSProps({\n            position: 'fixed',\n            top: `${this.getClientY(event)}px`,\n            left: `${this.getClientX(event)}px`,\n            maxWidth: `${this.windowProps.width - 10}px`,\n            maxHeight: `${this.windowProps.height - 10}px`,\n            overflow: 'auto'\n        });\n    }\n    /**\n     * Returns context menu's approximate position on X axis\n     * @param {Event} event Event object\n     */\n    getClientX(event) {\n        const displacement = event.clientX + this.targetPlacement.width - this.windowProps.width;\n        if (displacement > 0) {\n            return event.clientX - displacement - 4;\n        }\n        return event.clientX;\n    }\n    /**\n     * Returns context menu's approximate position on Y axis\n     * @param {Event} event Event object\n     */\n    getClientY(event) {\n        const displacement = event.clientY + this.targetPlacement.height - this.windowProps.height;\n        if (displacement > 0) {\n            return event.clientY - displacement - 4;\n        }\n        return event.clientY;\n    }\n}","import { Select } from './Select';\nimport { CursorPlacement } from './CursorPlacement';\n\n\nexport class ContextMenu {\n    #listeners = [];\n    #open = false;\n    constructor(target, config) {\n        if (config && typeof config === 'object') {\n            this.config = Object.freeze(config);\n        }\n        this.contextTarget = typeof target === 'string'\n            ? new Select(target)\n            : new Select().getBodyTag();\n        this.isSupported = !!this.contextTarget.body;\n        this.rootElement = Select.create(\n            this.config && this.config.rootElement\n                ? this.config.rootElement\n                : `<ul class=\"context-menu-list\"></ul>`\n        );\n        const ref = this;\n        const onContextMenu = function (e) {\n            e.preventDefault();\n            if (!ref.#open) {\n                (new Select(this)).append(ref.rootElement);\n                new CursorPlacement(e, ref.rootElement);\n                if (\n                    ref.config\n                    && typeof ref.config.onActivate === 'function'\n                ) {\n                    ref.rootElement.repaint();\n                    config.onActivate(ref.rootElement);\n                    ref.#open = true;\n                }\n            }\n        };\n        const exitFunction = () => {\n            this.rootElement = this.rootElement.detach().children();\n            this.#open = false;\n        };\n        const onClick = () => {\n            if (\n                this.config\n                && typeof config.onDeactivate === 'function'\n            ) {\n                config.onDeactivate(this.rootElement, exitFunction);\n            } else {\n                exitFunction();\n            }\n        };\n        const onRootClick = (e) => {\n            e.stopPropagation();\n            if (\n                this.config\n                && typeof this.config.onClick === 'function'\n            ) {\n                const shouldExit = this.config.onClick.apply(new Select(e.target), [e]);\n                if (shouldExit) {\n                    if (typeof this.config.onDeactivate === 'function') {\n                        this.config.onDeactivate(this.rootElement, exitFunction);\n                    } else {\n                        exitFunction();\n                    }\n                }\n            }\n        };\n        this.#listeners.push(\n            { onContextMenu },\n            { onClick },\n            { onRootClick }\n        );\n        this.contextTarget\n            .on('contextmenu', onContextMenu)\n            .on('click', onClick);\n        this.rootElement.on('click', onRootClick);\n    }\n    add() {\n        const elements = [...arguments];\n        for (const element of elements) {\n            if (\n                element instanceof ContextList\n                || element instanceof ContextItem\n            ) {\n                this.rootElement.append(element.rootElement);\n            }\n        }\n    }\n    cleanup() {\n        const { onContextMenu } = this.#listeners.filter(fn => Object.prototype.hasOwnProperty.call(fn, 'onContextMenu'))[0];\n        const { onClick } = this.#listeners.filter(fn => Object.prototype.hasOwnProperty.call(fn, 'onClick'))[0];\n        const { onRootClick } = this.#listeners.filter(fn => Object.prototype.hasOwnProperty.call(fn, 'onRootClick'))[0];\n        this.contextTarget\n            .off('contextmenu', onContextMenu)\n            .off('click', onClick);\n        this.rootElement.off('click', onRootClick);\n    }\n}\n\n// Generates a context list\nexport class ContextList {\n    constructor(title, config) {\n        if (config && typeof config === 'object') {\n            this.config = Object.freeze(config);\n        }\n        this.rootElement = Select.create(\n            this.config && this.config.rootElement\n                ? this.config.rootElement\n                : `<li class=\"menu-item\"></li>`\n        );\n        this.rootElement.setAttr({\n            'data-has-sub-elements': true\n        });\n        this.listElement = Select.create(\n            this.config && this.config.listElement\n                ? this.config.listElement\n                : `<ul class=\"context-submenu\"></ul>`\n        );\n        this.rootElement\n            .append(title)\n            .append(this.listElement);\n    }\n    get parent() {\n        return this.rootElement.parent;\n    }\n    add() {\n        const elements = [...arguments];\n        for (const element of elements) {\n            if (\n                element instanceof ContextList\n                || element instanceof ContextItem\n            ) {\n                this.listElement.append(element.rootElement);\n            }\n        }\n    }\n}\n\n// Generates a context item\nexport class ContextItem {\n    constructor(title, config) {\n        if (config && typeof config === 'object') {\n            this.config = Object.freeze();\n        }\n        this.rootElement = Select.create(\n            this.config && this.config.rootElement\n                ? this.config.rootElement\n                : `<li class=\"menu-item\"></li>`\n        );\n        this.rootElement.append(title);\n    }\n}"],"names":["Select","selector","body","document","elements","querySelectorAll","Node","NodeList","HTMLCollection","Object","prototype","hasOwnProperty","call","i","length","push","parent","getParentSelection","parentNodeList","map","el","parentNode","filter","selected","forEach","children","child","indexOf","nodes","consumableNodes","tempDiv","createElement","innerHTML","childNodes","target","appendChild","fragment","createDocumentFragment","n","cloneNode","currentFragment","detach","append","textContent","innerText","evaluatorFn","addEventListener","arguments","removeEventListener","eventType","cb","useCapture","ref","onceCb","apply","getBoundingClientRect","obj","keys","prop","style","attr","setAttribute","getAttribute","offsetHeight","contains","CursorPlacement","event","element","targetPlacement","bounds","windowProps","width","window","innerWidth","height","innerHeight","setCSSProps","position","top","getClientY","left","getClientX","maxWidth","maxHeight","overflow","displacement","clientX","clientY","ContextMenu","config","freeze","contextTarget","getBodyTag","isSupported","rootElement","create","onContextMenu","e","preventDefault","onActivate","repaint","exitFunction","onClick","onDeactivate","onRootClick","stopPropagation","shouldExit","on","ContextList","ContextItem","fn","off","title","setAttr","listElement"],"mappings":"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"}