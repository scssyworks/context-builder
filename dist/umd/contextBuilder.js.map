{"version":3,"file":"contextBuilder.js","sources":["../../src/Select/index.ts","../../src/CursorPlacement/index.ts","../../src/Beacon/index.ts","../../src/index.ts"],"sourcesContent":["import { Selector, TypeNodes } from \"../types\";\n\nexport type HTMLSelector = Select | Selector;\nexport type HTMLTypeNodes = Select | TypeNodes;\n\nexport class Select {\n    body: boolean | HTMLBodyElement;\n    elements: Node[];\n    parent: Select | null;\n    constructor(selector?: HTMLSelector) {\n        // Check if document and document.body exist\n        this.body = typeof document !== 'undefined' && !!document && (document.body as HTMLBodyElement);\n        // Resolve references\n        this.elements = [];\n        if (this.body && selector) {\n            if (typeof selector === 'string') {\n                this.elements = [...document.querySelectorAll(selector)] as Node[];\n            } else if (selector instanceof Node || selector instanceof EventTarget) {\n                this.elements = [selector] as Node[];\n            } else if (\n                selector instanceof NodeList\n                || selector instanceof HTMLCollection\n            ) {\n                this.elements = [...selector] as Node[];\n            } else if (Object.prototype.hasOwnProperty.call(selector, 'length')) { // For jQuery or jQuery like objects\n                for (let i = 0; i < (selector as Node[]).length; i++) {\n                    this.elements.push((selector as Node[])[i]);\n                }\n            } else if (selector instanceof Select) {\n                this.elements = [...selector.elements] as Node[];\n                this.parent = selector.parent;\n            }\n        }\n        // Resolve parent\n        this.parent = this.getParentNode();\n    }\n    /**\n     * Returns a Select object for parent nodes\n     */\n    getParentNode(): (Select | null) {\n        const parentNodeList = this.elements.map(el => el.parentNode).filter(el => !!el);\n        if (parentNodeList.length) {\n            return new Select(parentNodeList as Node[]);\n        }\n        return null;\n    }\n    /**\n     * Returns list of all parents\n     */\n    getAllParents(): Select[] {\n        let currRef: (Select | null) = new Select(this);\n        const parentsList = [] as Select[];\n        do {\n            currRef = currRef.getParentNode();\n            if (currRef) {\n                parentsList.push(currRef);\n            }\n        } while (currRef);\n        return parentsList;\n    }\n    /**\n     * Query children of current element\n     * @param {string} selector Selector\n     */\n    query(selector: string): Select {\n        const selected = [] as Node[];\n        this.elements.forEach(el => {\n            if (el instanceof HTMLElement) {\n                const children = [...el.querySelectorAll(selector)] as HTMLElement[];\n                children.forEach(child => {\n                    if (selected.indexOf(child) === -1) {\n                        selected.push(child);\n                    }\n                });\n            }\n        });\n        return new Select(selected);\n    }\n    /**\n     * Appends HTML body to current element(s)\n     * @param {string | Node | NodeList | HTMLCollection | Node[] | Select} nodes \n     */\n    append(nodes: HTMLTypeNodes): Select {\n        if (this.body) {\n            let consumableNodes: Select;\n            if (typeof nodes === 'string') {\n                // Expecting a plain HTML string\n                const tempDiv = document.createElement('div');\n                tempDiv.innerHTML = nodes;\n                consumableNodes = new Select(tempDiv.childNodes);\n            } else {\n                // For everything else treat them as regular nodes\n                consumableNodes = new Select(nodes);\n            }\n            this.elements.forEach((target, i) => {\n                if (consumableNodes.elements.length === 1) {\n                    target.appendChild(consumableNodes.elements[0]); // Keeping intact the original reference\n                } else {\n                    const fragment = document.createDocumentFragment();\n                    consumableNodes.elements.forEach(n => {\n                        fragment.appendChild(i === 0 ? n : n.cloneNode());\n                    });\n                    target.appendChild(fragment);\n                }\n            });\n        }\n        return this;\n    }\n    /**\n     * Prepends HTML body to current element(s)\n     * @param {string | Node | NodeList | HTMLCollection | Node[] | Select} nodes\n     */\n    prepend(nodes: HTMLTypeNodes): Select {\n        if (this.body) {\n            this.elements.forEach(target => {\n                const currentFragment = (new Select(target.childNodes)).detach();\n                (new Select(target)).append(nodes).append(currentFragment);\n            });\n        }\n        return this;\n    }\n    /**\n     * Removes current set of elements from DOM and return DocumentFragment as a Select instance\n     */\n    detach(): Select {\n        if (this.body) {\n            const fragment = document.createDocumentFragment();\n            this.elements.forEach(el => {\n                fragment.appendChild(el);\n            });\n            return new Select(fragment);\n        }\n        return this;\n    }\n    /**\n     * Clears current elements inner HTML\n     */\n    empty(): Select {\n        if (this.body) {\n            this.elements.forEach(el => {\n                if (el instanceof HTMLElement) {\n                    el.innerHTML = '';\n                }\n            });\n        }\n        return this;\n    }\n    /**\n     * Returns current map of HTML strings\n     */\n    htmlMap(): string[] {\n        return this.map((el: any) => {\n            if (el instanceof HTMLElement) {\n                return el.innerHTML;\n            }\n            return '';\n        });\n    }\n    /**\n     * Returns current map of text strings\n     */\n    textMap(): string[] {\n        return this.map(el => {\n            if (el instanceof HTMLElement) {\n                return el.textContent || el.innerText;\n            }\n            return '';\n        });\n    }\n    /**\n     * Returns current list of element as array\n     * @param {Function} evaluatorFn Evaluator function\n     */\n    map(evaluatorFn: (n: Node, i: number) => any): any[] {\n        if (!this.body || typeof evaluatorFn !== 'function') {\n            return this.elements;\n        }\n        return this.elements.map(evaluatorFn);\n    }\n    /**\n     * Returns current body tag as a Select instance\n     */\n    getBodyTag(): Select {\n        return new Select(this.body as HTMLBodyElement);\n    }\n    /**\n     * Returns current Select reference children\n     */\n    children(): Select {\n        const elements = [] as Node[];\n        this.elements.forEach(el => {\n            [...el.childNodes].forEach(n => {\n                if (elements.indexOf(n) === -1) {\n                    elements.push(n);\n                }\n            });\n        });\n        return new Select(elements);\n    }\n    /**\n     * Binds a regular event listener\n     */\n    on<K extends keyof WindowEventMap>(eventType: K, cb: (e: WindowEventMap[K]) => any, useCapture?: boolean): Select {\n        this.elements.forEach(el => {\n            el.addEventListener(eventType, cb as EventListener, useCapture);\n        });\n        return this;\n    }\n    /**\n     * Removes a regular event listener\n     */\n    off<K extends keyof WindowEventMap>(eventType: K, cb: (e: WindowEventMap[K]) => any, useCapture?: boolean): Select {\n        this.elements.forEach(el => {\n            el.removeEventListener(eventType, cb as EventListener, useCapture);\n        });\n        return this;\n    }\n    /**\n     * Auto detach event listener after first call\n     * @param {string} eventType Event name\n     * @param {Function} cb Callback function\n     * @param {boolean} useCapture Use capture mode\n     */\n    once<K extends keyof WindowEventMap>(eventType: K, cb: (e: WindowEventMap[K]) => any, useCapture?: boolean): Select {\n        const ref = this;\n        const onceCb = function (e: WindowEventMap[K]) {\n            cb.apply(this, [e]);\n            ref.elements.forEach(el => {\n                el.removeEventListener(eventType, onceCb, useCapture);\n            });\n        } as EventListener;\n        this.elements.forEach(el => {\n            el.addEventListener(eventType, onceCb, useCapture);\n        });\n        return this;\n    }\n    /**\n     * Returns map of DOMRect objects\n     */\n    bounds(): (DOMRect | null)[] {\n        return this.map(el => {\n            if (el instanceof HTMLElement) {\n                return el.getBoundingClientRect();\n            }\n            return null;\n        });\n    }\n    /**\n     * Sets CSS properties to element(s)\n     * @param {object} obj CSS properties\n     */\n    setCSSProps(obj: { [prop: string]: any }): Select {\n        this.elements.forEach(el => {\n            if (el instanceof HTMLElement) {\n                Object.keys(obj).forEach((prop: any) => {\n                    el.style[prop] = obj[prop];\n                });\n            }\n        });\n        return this;\n    }\n    /**\n     * Sets HTML element attributes\n     * @param {object} obj HTML element attributes\n     */\n    setAttr(obj: { [prop: string]: any }): Select {\n        this.elements.forEach(el => {\n            if (el instanceof HTMLElement) {\n                Object.keys(obj).forEach(attr => {\n                    el.setAttribute(attr, obj[attr]);\n                });\n            }\n        });\n        return this;\n    }\n    /**\n     * Returns a map of attribute values for selected elements\n     * @param {string} attr Attribute\n     */\n    getAttrMap(attr: string): string[] {\n        return this.map(el => {\n            if (el instanceof HTMLElement) {\n                return el.getAttribute(attr);\n            }\n            return undefined;\n        });\n    }\n    /**\n     * Enforce a repaint of targeted elements\n     */\n    reflow(): Select {\n        this.elements.forEach(el => {\n            if (el instanceof HTMLElement) {\n                el.offsetHeight; // Accessing offset height somehow triggers a reflow\n            }\n        });\n        return this;\n    }\n    /**\n     * Returns true if current element is contained in this selector\n     * @param {Node | NodeList | HTMLCollection | Select} nodes Element\n     */\n    contains(nodes: HTMLSelector): boolean {\n        return (new Select(nodes)).map(n => {\n            for (const el of this.elements) {\n                if (el.contains(n)) {\n                    return true;\n                }\n            }\n            return false;\n        }).indexOf(false) === -1;\n    }\n    /**\n     * Removes the current element from DOM entirely\n     */\n    remove(): Select {\n        this.elements.forEach(el => {\n            el.parentNode?.removeChild(el);\n        });\n        return this;\n    }\n    /**\n     * Static method to create a new HTML node\n     * @param {string | Node | NodeList | HTMLCollection | Node[] | Select} nodes\n     */\n    static create(nodes: HTMLTypeNodes): Select {\n        return (new Select(document.createDocumentFragment()))\n            .append(nodes)\n            .children();\n    }\n}","import { Select, HTMLSelector } from '../Select';\n\nexport class CursorPlacement {\n    target: Select;\n    targetPlacement: DOMRect | null;\n    windowProps: {\n        width: number,\n        height: number\n    };\n    constructor(event: MouseEvent, element: HTMLSelector) {\n        this.target = new Select(element);\n        this.targetPlacement = this.target.bounds()[0];\n        this.windowProps = {\n            width: window.innerWidth,\n            height: window.innerHeight\n        };\n        this.target.setCSSProps({\n            position: 'fixed',\n            top: `${this.getClientY(event)}px`,\n            left: `${this.getClientX(event)}px`,\n            maxWidth: `${this.windowProps.width - 10}px`,\n            maxHeight: `${this.windowProps.height - 10}px`,\n            overflow: 'auto'\n        });\n    }\n    /**\n     * Returns context menu's approximate position on X axis\n     * @param {Event} event Event object\n     */\n    getClientX(event: MouseEvent): number {\n        if (this.targetPlacement) {\n            const displacement = event.clientX + this.targetPlacement.width - this.windowProps.width;\n            if (displacement > 0) {\n                return event.clientX - displacement - 4;\n            }\n        }\n        return event.clientX;\n    }\n    /**\n     * Returns context menu's approximate position on Y axis\n     * @param {Event} event Event object\n     */\n    getClientY(event: MouseEvent): number {\n        if (this.targetPlacement) {\n            const displacement = event.clientY + this.targetPlacement.height - this.windowProps.height;\n            if (displacement > 0) {\n                return event.clientY - displacement - 4;\n            }\n        }\n        return event.clientY;\n    }\n}","import { ContextMenu } from \"..\";\n\nif (typeof window !== 'undefined') {\n    // Polyfill custom event\n    if (typeof window.CustomEvent === 'undefined') {\n        class CustomEvent<T> {\n            constructor(event: string, params?: CustomEventInit<T>) {\n                params = params || { bubbles: false, cancelable: false, detail: undefined };\n                const evt = document.createEvent('CustomEvent');\n                evt.initCustomEvent(event, params.bubbles as boolean, params.cancelable as boolean, params.detail);\n                return evt;\n            }\n        }\n        CustomEvent.prototype = window.Event.prototype;\n        window.CustomEvent = CustomEvent as any;\n    }\n}\n\nexport class Beacon<T extends HTMLElement> {\n    #parentThis: ContextMenu<T>;\n    #root: Document | undefined;\n    #beaconEvent = 'closecontextmenu';\n    #resolver?: (value: boolean) => void;\n    constructor(parentThis: ContextMenu<T>) {\n        this.#parentThis = parentThis;\n        if (typeof document !== 'undefined') {\n            this.#root = document;\n        }\n    }\n\n    emit(): void {\n        if (this.#root) {\n            const contextMenuClose = new CustomEvent(this.#beaconEvent, {\n                cancelable: true,\n                bubbles: true,\n                detail: {\n                    originContext: this.#parentThis\n                }\n            });\n            this.#root.dispatchEvent(contextMenuClose);\n        }\n    }\n\n    #beaconListener = (e: Event): void => {\n        const { originContext } = (e as CustomEvent).detail as { originContext: ContextMenu<T> };\n        if (typeof this.#resolver === 'function') {\n            this.#resolver(originContext !== this.#parentThis);\n        }\n    }\n\n    listen(resolve: (value: boolean) => void): void {\n        this.#resolver = resolve;\n        this.#root?.addEventListener(this.#beaconEvent, this.#beaconListener);\n    }\n\n    off(): void {\n        this.#root?.removeEventListener(this.#beaconEvent, this.#beaconListener);\n        this.#resolver = undefined;\n    }\n}","import { Select } from \"./Select\";\nimport { CursorPlacement } from \"./CursorPlacement\";\nimport { Beacon } from \"./Beacon\";\n\nexport interface ContextMenuConfig<T extends HTMLElement, U extends Event> {\n    rootElement?: T;\n    onClick?: (event: U) => boolean | void;\n    onActivate?: (elements: Select) => void;\n    onDeactivate?: (elements: Select, callback: () => void) => void;\n    onContextMenu?: (event: U) => void;\n}\n\nexport interface ContextListConfig<T extends HTMLElement, U extends HTMLElement> {\n    rootElement?: T;\n    listElement?: U;\n}\n\nexport interface ContextItemConfig<T extends HTMLElement> {\n    rootElement?: T;\n}\n\nexport class ContextMenu<T extends HTMLElement> {\n    #open = false;\n    #active = false;\n    #doc = typeof document !== 'undefined' && (new Select(document));\n    #beacon: Beacon<T>;\n    contextTarget: Select;\n    isSupported: boolean;\n    rootElement: Select;\n    config: ContextMenuConfig<T, Event> = {};\n    constructor(target: string | null, config?: ContextMenuConfig<T, Event>) {\n        this.#beacon = new Beacon(this);\n        if (config && typeof config === 'object') {\n            this.config = Object.freeze(config);\n        }\n        this.contextTarget = typeof target === 'string'\n            ? new Select(target)\n            : new Select().getBodyTag();\n        this.isSupported = !!this.contextTarget.body;\n        this.rootElement = Select.create(\n            this.config && this.config.rootElement\n                ? this.config.rootElement\n                : `<ul class=\"context-menu-list\"></ul>`\n        )\n            .setAttr({ 'data-context-menu-root': true })\n            .on('click', this.#onRootClick);\n        this.contextTarget\n            .setAttr({ 'data-context-menu-enabled': true })\n            .on('contextmenu', this.#onContextMenu);\n        if (this.#doc) {\n            this.#doc.on('click', this.#onClick);\n        }\n        this.#beacon.listen((shouldClose) => {\n            if (shouldClose) {\n                this.#onClick();\n            }\n        });\n    }\n    // Private functions\n    #exitFunction = (): void => {\n        this.rootElement = this.rootElement.detach().children();\n        this.#open = false;\n        this.#active = false;\n    }\n    #onClick = (): void => {\n        if (this.#active) {\n            if (\n                this.config\n                && typeof this.config.onDeactivate === 'function'\n            ) {\n                this.#open = true;\n                this.config.onDeactivate(this.rootElement, this.#exitFunction);\n            } else {\n                this.#exitFunction();\n            }\n        }\n    }\n    #onContextMenu = (e: MouseEvent): void => {\n        e.preventDefault();\n        e.stopPropagation(); // For nested context menus\n        this.#beacon.emit(); // Sends notification to other context menu instances to automatically close\n        this.#active = true;\n        if (!this.#open) {\n            this.contextTarget.append(this.rootElement);\n            new CursorPlacement(e, this.rootElement);\n            if (this.config) {\n                if (typeof this.config.onActivate === 'function') {\n                    this.rootElement.reflow();\n                    this.config.onActivate.apply(this.rootElement, [this.rootElement]);\n                }\n                if (typeof this.config.onContextMenu === 'function') {\n                    this.config.onContextMenu.apply(this.rootElement, [e]);\n                }\n            }\n        }\n    }\n    #onRootClick = (e: Event): void => {\n        e.stopPropagation();\n        if (\n            this.config\n            && typeof this.config.onClick === 'function'\n        ) {\n            const shouldExit = this.config.onClick.apply(new Select(e.target), [e]);\n            if (shouldExit) {\n                this.#onClick();\n            }\n        }\n    }\n    // Public methods\n    add(...args: (ContextList<HTMLElement, HTMLElement> | ContextItem<HTMLElement>)[]): ContextMenu<T> {\n        const elements = [...args];\n        for (const element of elements) {\n            if (\n                element instanceof ContextList\n                || element instanceof ContextItem\n            ) {\n                this.rootElement.append(element.rootElement);\n            }\n        }\n        return this;\n    }\n    cleanup(): void {\n        this.contextTarget\n            .off('contextmenu', this.#onContextMenu)\n            .off('click', this.#onClick);\n        this.rootElement.off('click', this.#onRootClick).remove();\n        if (this.#doc) {\n            this.#doc.off('click', this.#onClick);\n        }\n        this.#beacon.off();\n    }\n}\n\n// Generates a context list\nexport class ContextList<T extends HTMLElement, U extends HTMLElement> {\n    config: ContextListConfig<T, U> = {};\n    rootElement: Select;\n    listElement: Select;\n    constructor(title: string, config?: ContextListConfig<T, U>) {\n        if (config && typeof config === 'object') {\n            this.config = Object.freeze(config);\n        }\n        this.listElement = Select.create(\n            this.config && this.config.listElement\n                ? this.config.listElement\n                : `<ul class=\"context-submenu\"></ul>`\n        )\n            .setAttr({ 'data-context-submenu-root': true });\n        this.rootElement = Select.create(\n            this.config && this.config.rootElement\n                ? this.config.rootElement\n                : `<li class=\"menu-item\"></li>`\n        )\n            .setAttr({\n                'data-has-sub-elements': true\n            })\n            .append(title)\n            .append(this.listElement);\n    }\n    get parent(): (Select | null) {\n        return this.rootElement.parent;\n    }\n    add(...args: (ContextList<HTMLElement, HTMLElement> | ContextItem<HTMLElement>)[]): ContextList<T, U> {\n        const elements = [...args];\n        for (const element of elements) {\n            if (\n                element instanceof ContextList\n                || element instanceof ContextItem\n            ) {\n                this.listElement.append(element.rootElement);\n            }\n        }\n        return this;\n    }\n}\n\n// Generates a context item\nexport class ContextItem<T extends HTMLElement> {\n    config: ContextItemConfig<T> = {};\n    rootElement: Select;\n    constructor(title: string, config?: ContextItemConfig<T>) {\n        if (config && typeof config === 'object') {\n            this.config = Object.freeze(config);\n        }\n        this.rootElement = Select.create(\n            this.config && this.config.rootElement\n                ? this.config.rootElement\n                : `<li class=\"menu-item\"></li>`\n        )\n            .setAttr({ 'data-is-context-menu-leaf': true })\n            .append(title);\n    }\n}"],"names":["Select","selector","body","document","elements","querySelectorAll","Node","EventTarget","NodeList","HTMLCollection","Object","prototype","hasOwnProperty","call","i","length","push","parent","getParentNode","parentNodeList","map","el","parentNode","filter","currRef","parentsList","selected","forEach","HTMLElement","children","child","indexOf","nodes","consumableNodes","tempDiv","createElement","innerHTML","childNodes","target","appendChild","fragment","createDocumentFragment","n","cloneNode","currentFragment","detach","append","textContent","innerText","evaluatorFn","eventType","cb","useCapture","addEventListener","removeEventListener","ref","onceCb","e","apply","getBoundingClientRect","obj","keys","prop","style","attr","setAttribute","getAttribute","undefined","offsetHeight","contains","removeChild","CursorPlacement","event","element","targetPlacement","bounds","windowProps","width","window","innerWidth","height","innerHeight","setCSSProps","position","top","getClientY","left","getClientX","maxWidth","maxHeight","overflow","displacement","clientX","clientY","CustomEvent","params","bubbles","cancelable","detail","evt","createEvent","initCustomEvent","Event","Beacon","parentThis","originContext","contextMenuClose","dispatchEvent","resolve","ContextMenu","config","rootElement","onDeactivate","preventDefault","stopPropagation","emit","contextTarget","onActivate","reflow","onContextMenu","onClick","shouldExit","freeze","getBodyTag","isSupported","create","setAttr","on","listen","shouldClose","args","ContextList","ContextItem","off","remove","title","listElement"],"mappings":"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"}